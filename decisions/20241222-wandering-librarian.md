# Draft: The Wandering Librarian - Prototype

## The Context

We need a way to test if LLMs can create engaging narratives in games. This prototype will serve as a testbed for exploring the potential of LLM-driven dynamic storytelling within a simplified game environment.

## The Problem Statement

Traditional game stories are often static and predictable, limiting player agency and immersion. LLMs offer the potential to generate dynamic narratives that react to player choices and create emergent gameplay experiences.

## Describe how your proposal will work with code, pseudo-code, mock-ups, or diagrams

The Minimal Viable Product (MVP) will focus on a single core gameplay loop centered around a traveling librarian who visits a new procedurally generated village each day. The player interacts with villagers, learns their needs and desires, and provides them with books to fulfill those needs.

**Core Gameplay Loop:**

1. **Arrive in Village:**

   - The LLM generates a village with a simple map and a few key locations (e.g., town square, tavern, character homes).

   ```python
   # Pseudo-code for village generation
   def generate_village():
       village = {}
       village['name'] = LLM.generate_village_name()
       village['map'] = LLM.generate_map_layout()
       village['locations'] = LLM.generate_locations(3)  # Generate 3 locations
       village['characters'] = LLM.generate_characters(3) # Generate 3 characters
       return village
   ```

2. **Explore and Interact:**

   - The player explores the village and interacts with characters through dialogue.
   - Dialogue is dynamically generated by the LLM based on character backstories and player choices.

   ```python
   # Pseudo-code for dialogue interaction
   def talk_to_character(character_id):
       initial_dialogue = LLM.generate_initial_dialogue(character_id)
       display(initial_dialogue)
       player_response = get_player_input()
       while not end_conversation:
           response = LLM.generate_response(character_id, player_response)
           display(response)
           player_response = get_player_input()
   ```

3. **Fulfill Needs with Books:**
   - The player selects books from their inventory or purchases new ones to match character preferences.
   - The LLM generates character needs and desires related to reading (e.g., favorite genres, desired knowledge).
   ```python
   # Pseudo-code for fulfilling needs
   def give_book(character_id, book_title):
       character_reaction = LLM.generate_reaction(character_id, book_title)
       if character_reaction['satisfied']:
           update_character_state(character_id, 'satisfied')
           # Trigger potential story events or quests
       display(character_reaction['dialogue'])
   ```

**LLM Integration:**

- **World Generation:** Creates unique villages, maps, and locations.
- **Character Development:** Generates characters with backstories, desires, and reading preferences.
- **Dynamic Dialogue:** Handles conversations, reacting to player choices and gifted books.
- **Catalog Generation:** Creates a dynamic catalog of books with varying prices and rarities.

**Content Verification:**

- A verifier monitors LLM output to ensure coherence, filter inappropriate content, and maintain consistency.

**Goal-Task Planner Integration:**

- Defines actions (e.g., `select_book`, `talk_to_character`, `give_book`), goals (e.g., `character_satisfied`, `rare_book_found`), and tasks (e.g., `satisfy_character`, `find_rare_book`) within the game's domain.
- The `Plan.find_plan()` method helps generate sequences of actions to achieve goals.

## The Benefits

- **Rapid Iteration:** The simplified scope allows for quick testing and refinement of LLM-driven narratives.
- **Dynamic Storytelling:** Creates emergent narratives and unpredictable gameplay experiences.
- **Exploration of LLM Capabilities:** Provides valuable insights into using LLMs for interactive storytelling.

## The Downsides

- **Limited Scope:** The prototype focuses on a narrow aspect of gameplay.
- **LLM Unpredictability:** Requires careful monitoring and content filtering to ensure quality and consistency.

## The Road Not Taken

- Developing a full-fledged game with complex mechanics would be too time-consuming for initial exploration.

## The Infrequent Use Case

- While the core loop is designed for daily interaction, players may occasionally skip days or play less frequently. The LLM will need to handle these infrequent interactions seamlessly, potentially by adjusting the narrative or providing catch-up mechanisms.

## Why is it in Core and done by us?

This project aligns with our core focus on innovative game development and exploring the use of LLMs in interactive narratives. It requires deep integration with our existing technology and understanding of our long-term goals.

## Status

Status: Draft

## Decision Makers

- V-Sekai development team

## Tags

- V-Sekai
- LLM
- Prototype
- Procedural Generation
- Dynamic Narrative
- Books
- Librarian

## Further Reading

1. [V-Sekai Â· GitHub](https://github.com/v-sekai) - Official GitHub account for the V-Sekai development community focusing on social VR functionality for the Godot Engine.
2. [V-Sekai/v-sekai-game](https://github.com/v-sekai/v-sekai-game) is the GitHub page for the V-Sekai open-source project, which brings social VR/VRSNS/metaverse components to the Godot Engine.

AI assistant Aria assisted with this article.
